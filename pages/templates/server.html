<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/themes.css">
    <link rel="stylesheet" href="/css/components.css">
    <title>Discross - Menu</title>
    <script>
        function toggleCategory(categoryId) {
            var categoryDiv = document.getElementById('category_' + categoryId);
            var arrowSpan = document.getElementById('arrow_' + categoryId);
            
            if (categoryDiv && arrowSpan) {
                // Check current display using getComputedStyle for reliability
                var currentDisplay = window.getComputedStyle(categoryDiv).display;
                var isCollapsed = currentDisplay === 'none';
                categoryDiv.style.display = isCollapsed ? 'block' : 'none';
                arrowSpan.textContent = isCollapsed ? '▼' : '▶';
                
                // Save preference to server
                var serverID = window.location.pathname.split('/').pop();
                if (serverID && serverID.length > 0 && serverID !== 'server') {
                    fetch('/toggleCategory', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            serverID: serverID,
                            categoryID: categoryId,
                            collapsed: !isCollapsed
                        })
                    }).catch(function(err) {
                        console.error('Error saving category preference:', err);
                    });
                }
            }
        }
    </script>
</head>

<body {$WHITE_THEME_ENABLED}>
    <div id="wrapper">
        <table class="server-layout">
            <tbody>
                <tr>
                    <td class="server-sidebar">
                        <a href="/server/"><img src="/resources/logo.gif" alt="Home"></a><br>
                        <hr noshade>
                        {$SERVER_LIST}
                    </td>
                    <td class="server-main">
                        {$DISCORD_NAME}

                        {$CHANNEL_LIST}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</body>

</html>
